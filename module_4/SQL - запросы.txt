Задание 4.1
База данных содержит список аэропортов практически всех крупных городов России. В большинстве городов есть только один аэропорт. Исключение составляет:
SELECT a.city,
       count(DISTINCT a.airport_code) airport_count
FROM dst_project.airports AS a
GROUP BY a.city
HAVING count(DISTINCT a.airport_code) > 1
ORDER BY 2 DESC,
         1

Задание 4.2
Вопрос 1. Таблица рейсов содержит всю информацию о прошлых, текущих и запланированных рейсах. Сколько всего статусов для рейсов определено в таблице?
SELECT count(DISTINCT f.status) AS status_count
FROM dst_project.flights AS f

Вопрос 2. Какое количество самолетов находятся в воздухе на момент среза в базе (статус рейса «самолёт уже вылетел и находится в воздухе»).
SELECT count(f.flight_id)
FROM dst_project.flights AS f
WHERE f.status = 'Departed'

Вопрос 3. Места определяют схему салона каждой модели. Сколько мест имеет самолет модели 773  (Boeing 777-300)?
SELECT count(s.seat_no)
FROM dst_project.seats AS s
WHERE s.aircraft_code = '773'

Вопрос 4. Сколько состоявшихся (фактических) рейсов было совершено между 1 апреля 2017 года и 1 сентября 2017 года?
Здесь и далее состоявшийся рейс означает, что он не отменён, и самолёт прибыл в пункт назначения.

SELECT count(f.flight_id)
FROM dst_project.flights AS f
WHERE (actual_arrival BETWEEN '2017-04-01' AND '2017-09-01')
  AND (status = 'Arrived')


